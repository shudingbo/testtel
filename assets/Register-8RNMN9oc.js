import{d as J,v as Q,i as j,r as o,b as c,o as u,f as s,$ as E,x as w,e as f,y as S,u as a,t as d,aO as M,A as U,aP as z,aQ as G,an as H,q as K,aU as W,M as I,_ as X}from"./index-B-w5q43E.js";const Y={class:"register-modal-overlay"},Z={class:"register-modal"},ee={class:"input-group phone-input"},se=["placeholder"],te=["disabled"],oe={key:1,class:"error-message"},re={class:"input-group code-input"},ae=["placeholder"],le={key:0,class:"error-message"},ie={class:"input-group password-input"},ne=["type","placeholder"],ue={key:0,class:"error-message"},de={class:"input-group confirm-password-input"},ce=["type","placeholder"],ve={key:0,class:"error-message"},pe={class:"terms"},ge={for:"terms"},me={key:0,class:"error-message"},fe={type:"submit",class:"btn btn-primary register-submit-btn"},he={class:"login-link"},_e=J({__name:"Register",emits:["close","switchToLogin","registerSuccess"],setup(we,{emit:N}){const{t:e}=Q(),F=j(),R=N,l=o(""),v=o(""),y=o(""),h=o("password"),V=o(!1),_=o(""),b=o(0),C=o(!1),i=o(""),p=o(""),g=o(""),k=o(""),m=o(""),B=()=>{h.value=h.value==="password"?"text":"password"},T=()=>{const r=/^[0-9]{10,11}$/;l.value?r.test(l.value)?i.value="":i.value=e("register.phoneInvalid"):i.value=e("register.phoneRequired")},q=()=>{v.value?v.value.length<8?p.value=e("register.passwordTooShort"):p.value="":p.value=e("register.passwordRequired")},P=()=>{y.value?y.value!==v.value?g.value=e("register.passwordsNotMatch"):g.value="":g.value=e("register.confirmPasswordRequired")},$=async()=>{if(T(),q(),P(),x(),V.value)k.value="";else{k.value=e("register.termsRequired");return}if(x(),i.value||p.value||g.value||m.value)return;await F.register(l.value,v.value,_.value)===!0&&R("registerSuccess",{phone:l.value})},D=()=>{R("close")},L=async()=>{if(T(),!i.value)try{const r=await W(l.value);r.code===0?(O(),I.success(e("register.sendCodeSucces"))):(console.error("send VCode Fail:",r.message),I.warning(r.message??e("register.sendCodeFailed")))}catch(r){console.error("send VCode Fail:",r),I.warning(e("register.sendCodeFailed"))}},O=()=>{C.value=!0,b.value=60;const r=setInterval(()=>{b.value--,b.value<=0&&(clearInterval(r),C.value=!1)},1e3)},x=()=>{_.value?_.value.length<4?m.value=e("register.codeInvalid"):m.value="":m.value=e("register.codeRequired")},A=()=>{R("switchToLogin")};return(r,t)=>(u(),c("div",Y,[s("div",Z,[s("button",{class:"close-button",onClick:D},"×"),t[7]||(t[7]=s("h2",null,"Register",-1)),s("form",{onSubmit:E($,["prevent"])},[s("div",ee,[t[5]||(t[5]=s("span",{class:"country-code"},"+55 ",-1)),w(s("input",{type:"tel","onUpdate:modelValue":t[0]||(t[0]=n=>l.value=n),placeholder:a(e)("register.phoneTip"),required:"",onInput:T},null,40,se),[[S,l.value]]),i.value.length===0&&l.value.length>0?(u(),c("button",{key:0,type:"button",class:"send-code-btn",onClick:L,disabled:C.value||!l.value||i.value.length>0},d(C.value?`${b.value}s`:a(e)("register.sendCode")),9,te)):f("",!0),i.value?(u(),c("div",oe,d(i.value),1)):f("",!0)]),s("div",re,[w(s("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=n=>_.value=n),placeholder:a(e)("register.codeTip"),required:"",onInput:x},null,40,ae),[[S,_.value]]),m.value?(u(),c("div",le,d(m.value),1)):f("",!0)]),s("div",ie,[w(s("input",{type:h.value,"onUpdate:modelValue":t[2]||(t[2]=n=>v.value=n),placeholder:a(e)("register.passwordTip"),required:"",onInput:q},null,40,ne),[[M,v.value]]),s("button",{type:"button",class:"toggle-password",onClick:B},[h.value==="password"?(u(),U(a(z),{key:0})):(u(),U(a(G),{key:1}))]),p.value?(u(),c("div",ue,d(p.value),1)):f("",!0)]),s("div",de,[w(s("input",{type:h.value,"onUpdate:modelValue":t[3]||(t[3]=n=>y.value=n),placeholder:a(e)("register.confirmPasswordTip"),required:"",onInput:P},null,40,ce),[[M,y.value]]),g.value?(u(),c("div",ve,d(g.value),1)):f("",!0)]),s("div",pe,[w(s("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=n=>V.value=n),id:"terms"},null,512),[[H,V.value]]),s("label",ge,d(a(e)("register.agreeTerms")),1),k.value?(u(),c("div",me,d(k.value),1)):f("",!0)]),s("button",fe,d(a(e)("login.register")),1)],32),s("div",he,[t[6]||(t[6]=K(" Já tem uma conta? ")),s("a",{href:"#",onClick:E(A,["prevent"])},d(a(e)("register.loginNow")),1)])])]))}}),be=X(_e,[["__scopeId","data-v-f5fe35af"]]);export{be as default};
