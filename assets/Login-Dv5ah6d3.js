import{d as E,a as D,r as a,A as k,o as u,l as j,f as e,$ as x,x as F,b as V,e as S,y as T,t as f,aO as L,u as p,aP as B,aQ as M,D as z,aR as G,M as y,aS as H,aT as J,_ as O,v as K,i as X,c as Y,q as Z,F as ee}from"./index-B-w5q43E.js";const se={class:"input-group phone-input"},oe=["disabled"],te={key:1,class:"error-message"},ae={class:"input-group code-input"},le={key:0,class:"error-message"},ne={class:"input-group password-input"},re=["type"],ie={key:0,class:"error-message"},ue={class:"button-group"},de=["disabled"],ce=E({__name:"ForgotPassword",props:{show:{type:Boolean}},emits:["close","success"],setup(q,{emit:I}){const g=q,C=I,_=D({get:()=>g.show,set:s=>{s||C("close")}}),o=a(""),r=a(""),l=a(""),d=a(!1),P=a("password"),m=a(0),h=a(!1),n=a(""),c=a(""),v=a(""),$=D(()=>o.value.length>0&&r.value.length>=4&&l.value.length>=8&&!n.value&&!c.value&&!v.value),t=()=>{P.value=P.value==="password"?"text":"password"},w=()=>{const s=/^[0-9]{10,11}$/;o.value?s.test(o.value)?n.value="":n.value="Invalid phone number format":n.value="Phone number is required"},R=()=>{r.value?r.value.length<4?c.value="Invalid verification code":c.value="":c.value="Verification code is required"},U=()=>{l.value?l.value.length<8?v.value="Password must be at least 8 characters":v.value="":v.value="New password is required"},A=async()=>{if(w(),!n.value)try{const s=await G(o.value);s.code===0?(Q(),y.success("Verification code sent successfully")):(console.error("Send verification code failed:",s.message),y.warning(s.message||"Failed to send verification code"))}catch(s){console.error("Send verification code failed:",s),y.warning("Failed to send verification code")}},Q=()=>{h.value=!0,m.value=60;const s=setInterval(()=>{m.value--,m.value<=0&&(clearInterval(s),h.value=!1)},1e3)},W=async()=>{if(w(),R(),U(),!!$.value){d.value=!0;try{const s=await H(o.value,J(l.value),r.value);s.code===0?(y.success("Password recovered successfully"),setTimeout(()=>{C("success"),N()},3e3)):y.error(s.message||"Failed to recover password")}catch(s){console.error("Forgot password error:",s),y.error("Failed to recover password")}finally{d.value=!1}}},N=()=>{o.value="",r.value="",l.value="",n.value="",c.value="",v.value="",d.value=!1,m.value=0,h.value=!1,C("close")};return(s,i)=>(u(),k(z,{modelValue:_.value,"onUpdate:modelValue":i[3]||(i[3]=b=>_.value=b),title:s.$t("login.forgotPassword"),width:"400px","close-on-click-modal":!1,onClose:N},{default:j(()=>[e("form",{onSubmit:x(W,["prevent"])},[e("div",se,[i[4]||(i[4]=e("span",{class:"country-code"},"+55 ",-1)),F(e("input",{type:"tel","onUpdate:modelValue":i[0]||(i[0]=b=>o.value=b),placeholder:"Phone Number",required:"",onInput:w},null,544),[[T,o.value]]),n.value.length===0&&o.value.length>0?(u(),V("button",{key:0,type:"button",class:"send-code-btn",onClick:A,disabled:h.value||!o.value||n.value.length>0},f(h.value?`${m.value}s`:"Send Code"),9,oe)):S("",!0),n.value?(u(),V("div",te,f(n.value),1)):S("",!0)]),e("div",ae,[F(e("input",{type:"text","onUpdate:modelValue":i[1]||(i[1]=b=>r.value=b),placeholder:"Verification Code",required:"",onInput:R},null,544),[[T,r.value]]),c.value?(u(),V("div",le,f(c.value),1)):S("",!0)]),e("div",ne,[F(e("input",{type:P.value,"onUpdate:modelValue":i[2]||(i[2]=b=>l.value=b),placeholder:"New Password",required:"",onInput:U},null,40,re),[[L,l.value]]),e("button",{type:"button",class:"toggle-password",onClick:t},[P.value==="password"?(u(),k(p(B),{key:0})):(u(),k(p(M),{key:1}))]),v.value?(u(),V("div",ie,f(v.value),1)):S("",!0)]),e("div",ue,[e("button",{type:"button",class:"btn btn-cancel",onClick:N},"Cancel"),e("button",{type:"submit",class:"btn btn-primary",disabled:!$.value||d.value},f(d.value?"Recovering...":s.$t("login.resetPassword")),9,de)])],32)]),_:1},8,["modelValue","title"]))}}),ve=O(ce,[["__scopeId","data-v-b4623aef"]]),pe={class:"login-modal-overlay"},ge={class:"login-modal"},we={class:"input-group phone-input"},fe=["placeholder"],me={class:"input-group password-input"},he=["type","placeholder"],be={class:"forgot-password"},ye={type:"submit",class:"btn btn-primary login-submit-btn"},_e={class:"register-link"},Pe=E({__name:"Login",emits:["close","switchToRegister","loginSuccess"],setup(q,{emit:I}){const{t:g}=K(),C=X(),_=I,o=a(""),r=a(""),l=a("password"),d=a(!1),P=()=>{l.value=l.value==="password"?"text":"password"},m=async()=>{await C.login({username:o.value,pwd:r.value})===!0?_("loginSuccess",{phone:o.value}):y.warning(g("login.WrongPhonePass"))},h=()=>{_("close")},n=()=>{_("switchToRegister")},c=()=>{d.value=!0},v=()=>{};return($,t)=>(u(),V(ee,null,[e("div",pe,[e("div",ge,[e("button",{class:"close-button",onClick:h},"×"),t[5]||(t[5]=e("h2",null,"Login",-1)),e("form",{onSubmit:x(m,["prevent"])},[e("div",we,[t[3]||(t[3]=e("span",{class:"country-code"},"+55 ",-1)),F(e("input",{type:"tel","onUpdate:modelValue":t[0]||(t[0]=w=>o.value=w),placeholder:p(g)("login.phoneTip"),required:""},null,8,fe),[[T,o.value]])]),e("div",me,[F(e("input",{type:l.value,"onUpdate:modelValue":t[1]||(t[1]=w=>r.value=w),placeholder:p(g)("login.passwordTip"),required:""},null,8,he),[[L,r.value]]),e("button",{type:"button",class:"toggle-password",onClick:P},[l.value==="password"?(u(),k(p(B),{key:0})):(u(),k(p(M),{key:1}))])]),e("div",be,[e("a",{href:"#",onClick:x(c,["prevent"])},f(p(g)("login.forgotPassword")),1)]),e("button",ye,f(p(g)("login.login")),1)],32),e("div",_e,[t[4]||(t[4]=Z(" Novo no 9d.bet.br? ")),e("a",{href:"#",onClick:x(n,["prevent"])},f(p(g)("login.registerNow")),1)])])]),Y(ve,{show:d.value,onClose:t[2]||(t[2]=w=>d.value=!1),onSuccess:v},null,8,["show"])],64))}}),Ve=O(Pe,[["__scopeId","data-v-c4b02708"]]);export{Ve as default};
